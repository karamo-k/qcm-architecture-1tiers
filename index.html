<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>QCM ‚Äî R√©seaux & TCP/IP</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet"/>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
:root{
  --bg:#09090f;--surface:#13131f;--surface2:#1c1c2e;--border:#2a2a40;
  --accent:#6c63ff;--accent2:#ff6584;--gold:#ffd700;
  --text:#e8e8f0;--muted:#8888aa;--radius:16px;
  --font:'Space Grotesk',sans-serif;--mono:'JetBrains Mono',monospace;
}
body{font-family:var(--font);background:var(--bg);color:var(--text);min-height:100vh;}
.app{max-width:430px;margin:0 auto;min-height:100vh;position:relative;overflow-x:hidden;}
.glow{position:fixed;border-radius:50%;filter:blur(80px);opacity:.13;pointer-events:none;z-index:0;}
.g1{width:300px;height:300px;background:#6c63ff;top:-100px;right:-80px;}
.g2{width:250px;height:250px;background:#ff6584;bottom:60px;left:-100px;}

/* ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ */
.screen{position:relative;z-index:1;display:none;}
.screen.active{display:block;}

/* ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ */
#loginScreen{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 20px;gap:28px;}
#loginScreen.active{display:flex;}
.logo-wrap{display:flex;flex-direction:column;align-items:center;gap:12px;text-align:center;}
.logo-icon{width:82px;height:82px;background:linear-gradient(135deg,#6c63ff,#ff6584);border-radius:24px;display:flex;align-items:center;justify-content:center;font-size:38px;box-shadow:0 0 40px rgba(108,99,255,.45);}
.logo-title{font-size:22px;font-weight:800;background:linear-gradient(135deg,#6c63ff,#ff6584);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.logo-sub{color:var(--muted);font-size:13px;}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:26px 22px;width:100%;display:flex;flex-direction:column;gap:18px;}
.field-group{display:flex;flex-direction:column;gap:6px;}
.field-label{font-size:11px;font-weight:700;color:var(--muted);letter-spacing:1px;text-transform:uppercase;}
.field-input{background:var(--surface2);border:1.5px solid var(--border);border-radius:10px;padding:13px 15px;color:var(--text);font-family:var(--font);font-size:15px;outline:none;transition:border-color .2s;width:100%;}
.field-input:focus{border-color:var(--accent);}
.field-input::placeholder{color:#44445a;}
.btn-primary{width:100%;padding:15px;background:linear-gradient(135deg,#6c63ff,#9f7aea);border:none;border-radius:12px;color:#fff;font-family:var(--font);font-size:16px;font-weight:700;cursor:pointer;box-shadow:0 4px 20px rgba(108,99,255,.4);transition:opacity .2s,transform .1s;}
.btn-primary:hover{opacity:.9;}
.btn-primary:active{transform:scale(.98);}
.error-msg{color:#fc8181;font-size:13px;text-align:center;background:rgba(252,129,129,.1);border-radius:8px;padding:10px;display:none;}
.info-box{background:rgba(108,99,255,.08);border:1px solid rgba(108,99,255,.2);border-radius:10px;padding:14px 16px;font-size:13px;color:var(--muted);line-height:1.7;width:100%;}
.info-box strong{color:var(--accent);}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
.qcm-header{position:sticky;top:0;z-index:10;background:rgba(9,9,15,.96);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:14px 18px 12px;}
.header-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.user-badge{display:flex;align-items:center;gap:9px;}
.avatar{width:33px;height:33px;background:linear-gradient(135deg,#6c63ff,#ff6584);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:800;}
.u-name{font-size:13px;font-weight:600;}
.u-spec{font-size:11px;color:var(--muted);}
.timer{display:flex;align-items:center;gap:6px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:6px 12px;font-family:var(--mono);font-size:16px;font-weight:700;}
.timer.urgent{color:#fc8181;border-color:rgba(252,129,129,.4);animation:pulse 1s infinite;}
.tdot{width:6px;height:6px;border-radius:50%;background:#68d391;}
.tdot.urgent{background:#fc8181;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.55}}
.prog-wrap{background:var(--border);border-radius:99px;height:4px;}
.prog-fill{height:4px;border-radius:99px;background:linear-gradient(90deg,#6c63ff,#ff6584);transition:width .35s;}
.prog-text{font-size:11px;color:var(--muted);margin-top:5px;display:flex;justify-content:space-between;}

/* ‚îÄ‚îÄ QUESTION ‚îÄ‚îÄ */
.qcm-body{padding:20px 16px 105px;}
.sec-pill{display:inline-flex;align-items:center;gap:6px;padding:5px 12px;border-radius:99px;font-size:11px;font-weight:700;letter-spacing:.5px;margin-bottom:14px;}
.q-num{font-size:12px;color:var(--muted);font-weight:700;letter-spacing:1px;margin-bottom:8px;}
.q-text{font-size:17px;font-weight:700;line-height:1.5;margin-bottom:22px;}
.options{display:flex;flex-direction:column;gap:10px;}
.opt{display:flex;align-items:flex-start;gap:12px;background:var(--surface);border:1.5px solid var(--border);border-radius:12px;padding:14px 16px;cursor:pointer;transition:all .17s;text-align:left;width:100%;}
.opt:hover{border-color:#44446a;}
.opt.selected{border-color:var(--accent);background:rgba(108,99,255,.12);}
.opt.correct{border-color:#68d391;background:rgba(104,211,145,.12);}
.opt.wrong{border-color:#fc8181;background:rgba(252,129,129,.12);}
.opt-label{min-width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:800;background:var(--surface2);color:var(--muted);flex-shrink:0;transition:all .17s;}
.opt.selected .opt-label{background:var(--accent);color:#fff;}
.opt.correct .opt-label{background:#68d391;color:#1a3a2a;}
.opt.wrong .opt-label{background:#fc8181;color:#3a1a1a;}
.opt-text{font-size:14px;line-height:1.45;color:var(--text);padding-top:4px;}

/* ‚îÄ‚îÄ NAV BAR ‚îÄ‚îÄ */
.nav-bar{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:430px;background:rgba(19,19,31,.97);backdrop-filter:blur(16px);border-top:1px solid var(--border);padding:12px 16px 22px;display:flex;gap:10px;align-items:center;z-index:20;}
.btn-nav{flex:1;padding:13px;border-radius:10px;font-family:var(--font);font-size:14px;font-weight:700;cursor:pointer;border:none;transition:all .15s;}
.btn-prev{background:var(--surface2);color:var(--text);border:1px solid var(--border);}
.btn-prev:hover{background:var(--border);}
.btn-prev:disabled{opacity:.3;cursor:not-allowed;}
.btn-next{background:linear-gradient(135deg,#6c63ff,#9f7aea);color:#fff;}
.btn-next:disabled{opacity:.3;cursor:not-allowed;}
.btn-submit{background:linear-gradient(135deg,#48bb78,#38a169);color:#fff;font-size:13px;}
.btn-map{width:40px;height:40px;border-radius:8px;background:var(--surface2);border:1px solid var(--border);color:var(--muted);cursor:pointer;font-size:18px;flex-shrink:0;}
.btn-map:hover{border-color:var(--accent);color:var(--text);}

/* ‚îÄ‚îÄ MAP MODAL ‚îÄ‚îÄ */
.modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(4px);z-index:50;align-items:flex-end;}
.modal-bg.open{display:flex;}
.map-sheet{background:var(--surface);border-radius:20px 20px 0 0;border-top:1px solid var(--border);padding:18px 18px 32px;width:100%;max-height:65vh;overflow-y:auto;}
.map-handle{width:40px;height:4px;background:var(--border);border-radius:99px;margin:0 auto 18px;}
.map-title{font-size:15px;font-weight:700;margin-bottom:14px;}
.map-grid{display:grid;grid-template-columns:repeat(8,1fr);gap:6px;}
.map-cell{aspect-ratio:1;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;cursor:pointer;border:1.5px solid var(--border);background:var(--surface2);color:var(--muted);transition:all .15s;}
.map-cell.answered{background:rgba(108,99,255,.3);border-color:var(--accent);color:var(--accent);}
.map-cell.current{background:var(--accent);color:#fff;border-color:var(--accent);}

/* ‚îÄ‚îÄ CONFIRM MODAL ‚îÄ‚îÄ */
.confirm-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(4px);z-index:60;align-items:center;justify-content:center;padding:24px;}
.confirm-bg.open{display:flex;}
.confirm-card{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:28px 22px;width:100%;max-width:340px;}
.confirm-icon{font-size:40px;text-align:center;margin-bottom:14px;}
.confirm-title{font-size:20px;font-weight:800;text-align:center;margin-bottom:8px;}
.confirm-sub{font-size:14px;color:var(--muted);text-align:center;margin-bottom:22px;line-height:1.6;}
.confirm-sub strong{color:var(--text);}
.confirm-btns{display:flex;gap:10px;}
.btn-cancel{flex:1;padding:13px;background:var(--surface2);border:1px solid var(--border);border-radius:10px;color:var(--text);font-family:var(--font);font-size:14px;cursor:pointer;}
.btn-confirm{flex:1;padding:13px;background:linear-gradient(135deg,#48bb78,#38a169);border:none;border-radius:10px;color:#fff;font-family:var(--font);font-size:14px;font-weight:700;cursor:pointer;}

/* ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ */
#resultsScreen{padding:20px 16px 40px;}
.timeout-badge{background:rgba(252,129,129,.12);border:1px solid rgba(252,129,129,.3);border-radius:10px;padding:10px 14px;font-size:13px;color:#fc8181;text-align:center;margin-bottom:16px;display:none;}
.results-hero{text-align:center;padding:24px 0 20px;margin-bottom:20px;}
.score-ring{width:140px;height:140px;margin:0 auto 16px;position:relative;}
.score-svg{transform:rotate(-90deg);}
.ring-bg{fill:none;stroke:var(--border);stroke-width:10;}
.ring-fill{fill:none;stroke-width:10;stroke-linecap:round;transition:stroke-dashoffset 1.2s ease;}
.score-inner{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;}
.score-num{font-size:34px;font-weight:800;}
.score-den{font-size:14px;color:var(--muted);}
.score-grade{font-size:26px;font-weight:800;margin-bottom:5px;}
.score-user{font-size:13px;color:var(--muted);}
.stats-row{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:22px;}
.stat-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:14px 8px;text-align:center;}
.stat-val{font-size:22px;font-weight:800;}
.stat-lbl{font-size:11px;color:var(--muted);margin-top:2px;}
.sec-results{margin-bottom:18px;}
.sec-results h3{font-size:12px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:10px;padding-left:2px;}
.result-item{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:12px 14px;margin-bottom:8px;display:flex;gap:10px;align-items:flex-start;}
.r-icon{font-size:16px;flex-shrink:0;margin-top:2px;}
.r-q{font-size:13px;line-height:1.4;margin-bottom:4px;font-weight:600;}
.r-a{font-size:12px;margin-bottom:2px;}
.r-a.ok{color:#68d391;}
.r-a.ko{color:#fc8181;}
.r-correct{font-size:12px;color:#68d391;}
.sync-btn{width:100%;padding:15px;border-radius:12px;background:linear-gradient(135deg,#6c63ff,#9f7aea);border:none;color:#fff;font-family:var(--font);font-size:15px;font-weight:700;cursor:pointer;margin-top:10px;box-shadow:0 4px 20px rgba(108,99,255,.35);transition:opacity .2s;}
.sync-btn:hover{opacity:.9;}
.sync-btn.synced{background:linear-gradient(135deg,#48bb78,#38a169);box-shadow:0 4px 20px rgba(72,187,120,.3);}
.reset-btn{width:100%;padding:13px;border-radius:12px;background:transparent;border:1.5px solid var(--border);color:var(--muted);font-family:var(--font);font-size:14px;font-weight:600;cursor:pointer;margin-top:8px;transition:all .2s;}
.reset-btn:hover{border-color:var(--accent);color:var(--text);}

@keyframes slideUp{from{transform:translateY(18px);opacity:0}to{transform:translateY(0);opacity:1}}
.slide-up{animation:slideUp .35s ease;}
</style>
</head>
<body>
<div class="app">
  <div class="glow g1"></div>
  <div class="glow g2"></div>

  <!-- ‚ïê‚ïê LOGIN ‚ïê‚ïê -->
  <div id="loginScreen" class="screen active slide-up">
    <div class="logo-wrap">
      <div class="logo-icon">üåê</div>
      <div class="logo-title">QCM ‚Äî R√©seaux & TCP/IP</div>
      <div class="logo-sub">40 questions ¬∑ 1h30 ¬∑ Karamo CAMARA</div>
    </div>
    <div class="card">
      <div class="field-group">
        <div class="field-label">Nom</div>
        <input class="field-input" id="inputNom" placeholder="Votre nom de famille" type="text"/>
      </div>
      <div class="field-group">
        <div class="field-label">Pr√©nom</div>
        <input class="field-input" id="inputPrenom" placeholder="Votre pr√©nom" type="text"/>
      </div>
      <div class="field-group">
        <div class="field-label">Sp√©cialit√© (mot de passe)</div>
        <input class="field-input" id="inputSpec" placeholder="ex: miage, info, reseaux‚Ä¶" type="password"/>
      </div>
      <div class="error-msg" id="loginError">‚ö†Ô∏è Veuillez remplir tous les champs.</div>
      <button class="btn-primary" onclick="startExam()">Commencer l'examen ‚Üí</button>
    </div>
    <div class="info-box">
      üïê Dur√©e : <strong>1h 30 min</strong><br/>
      üìã <strong>40 questions</strong> √† choix unique<br/>
      ‚ö° Soumission automatique √† la fin du temps<br/>
      üì° Synchronisation des r√©sultats disponible apr√®s correction
    </div>
  </div>

  <!-- ‚ïê‚ïê QCM ‚ïê‚ïê -->
  <div id="qcmScreen" class="screen">
    <div class="qcm-header">
      <div class="header-top">
        <div class="user-badge">
          <div class="avatar" id="avatarEl"></div>
          <div>
            <div class="u-name" id="uName"></div>
            <div class="u-spec" id="uSpec"></div>
          </div>
        </div>
        <div class="timer" id="timerEl">
          <div class="tdot" id="tdot"></div>
          <span id="timerText">01:30:00</span>
        </div>
      </div>
      <div class="prog-wrap"><div class="prog-fill" id="progFill" style="width:0%"></div></div>
      <div class="prog-text">
        <span id="progText">0/40 r√©pondues</span>
        <span id="qPosText">Q1 sur 40</span>
      </div>
    </div>

    <div class="qcm-body" id="qcmBody"></div>

    <div class="nav-bar">
      <button class="btn-map" id="btnMap" title="Carte des questions">‚äû</button>
      <button class="btn-nav btn-prev" id="btnPrev" onclick="navigate(-1)">‚Üê Pr√©c.</button>
      <button class="btn-nav btn-next" id="btnNext" onclick="navigate(1)">Suiv. ‚Üí</button>
      <button class="btn-nav btn-submit" id="btnSubmit" onclick="openConfirm()" style="display:none">‚úÖ Terminer</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê RESULTS ‚ïê‚ïê -->
  <div id="resultsScreen" class="screen">
    <div class="timeout-badge" id="timeoutBadge">‚è∞ Temps √©coul√© ‚Äî examen soumis automatiquement</div>
    <div class="results-hero">
      <div class="score-ring">
        <svg class="score-svg" width="140" height="140" viewBox="0 0 140 140">
          <circle class="ring-bg" cx="70" cy="70" r="54"/>
          <circle class="ring-fill" id="ringFill" cx="70" cy="70" r="54"
            stroke="#6c63ff" stroke-dasharray="339.3" stroke-dashoffset="339.3"/>
        </svg>
        <div class="score-inner">
          <div class="score-num" id="scoreNum">0</div>
          <div class="score-den">/ 40</div>
        </div>
      </div>
      <div class="score-grade" id="scoreGrade"></div>
      <div class="score-user" id="scoreUser"></div>
    </div>
    <div class="stats-row" id="statsRow"></div>
    <div id="sectionResults"></div>
    <button class="sync-btn" id="syncBtn" onclick="syncResults()">üì° Synchroniser mes r√©sultats</button>
    <button class="reset-btn" onclick="resetApp()">üîÑ Nouvelle session</button>
  </div>
</div>

<!-- MAP MODAL -->
<div class="modal-bg" id="mapModal" onclick="closeMap(event)">
  <div class="map-sheet">
    <div class="map-handle"></div>
    <div class="map-title" id="mapTitle">üìã Navigation</div>
    <div class="map-grid" id="mapGrid"></div>
  </div>
</div>

<!-- CONFIRM MODAL -->
<div class="confirm-bg" id="confirmModal">
  <div class="confirm-card">
    <div class="confirm-icon">üì§</div>
    <div class="confirm-title">Soumettre l'examen ?</div>
    <div class="confirm-sub" id="confirmSub"></div>
    <div class="confirm-btns">
      <button class="btn-cancel" onclick="closeConfirm()">Annuler</button>
      <button class="btn-confirm" onclick="submitExam(false)">Confirmer</button>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const QUESTIONS = [
  {num:1,section:"R√©seaux & Topologies",q:"Qu'est-ce qu'un r√©seau informatique ?",opts:["Un ensemble de logiciels install√©s sur un seul ordinateur","Un ensemble d'ordinateurs, p√©riph√©riques et √©quipements interconnect√©s pour √©changer des donn√©es","Un syst√®me de stockage de fichiers locaux","Un protocole de communication entre deux machines"],ans:1},
  {num:2,section:"R√©seaux & Topologies",q:"Parmi les propositions suivantes, laquelle n'est PAS un objectif d'un r√©seau informatique ?",opts:["Partage de ressources (imprimantes, fichiers)","Communication entre utilisateurs","Augmentation de la vitesse du processeur","Acc√®s √† Internet"],ans:2},
  {num:3,section:"R√©seaux & Topologies",q:"Quel √©quipement est le n≈ìud central dans une topologie en √©toile ?",opts:["Routeur","Modem","Hub ou Switch","R√©p√©teur"],ans:2},
  {num:4,section:"R√©seaux & Topologies",q:"Dans une topologie en bus, quel composant est plac√© aux extr√©mit√©s du c√¢ble pour √©viter les rebonds de signal ?",opts:["Un r√©p√©teur","Un bouchon de terminaison","Un concentrateur","Un connecteur RJ45"],ans:1},
  {num:5,section:"R√©seaux & Topologies",q:"Quelle topologie utilise un c√¢ble coaxial avec des connecteurs en T ?",opts:["Topologie en √©toile","Topologie en anneau","Topologie en bus","Topologie en maille"],ans:2},
  {num:6,section:"R√©seaux & Topologies",q:"Quel est l'avantage principal de la topologie en √©toile par rapport √† la topologie en bus ?",opts:["Elle utilise moins de c√¢bles","Elle est moins co√ªteuse","Une panne d'un ordinateur n'affecte pas le reste du r√©seau","Elle ne n√©cessite aucun √©quipement central"],ans:2},
  {num:7,section:"R√©seaux & Topologies",q:"Dans une topologie en anneau, chaque ordinateur joue le r√¥le de :",opts:["Routeur","R√©p√©teur","Concentrateur","Commutateur"],ans:1},
  {num:8,section:"R√©seaux & Topologies",q:"Combien de c√¢bles sont n√©cessaires pour une topologie en maille compl√®te avec N n≈ìuds ?",opts:["N c√¢bles","N-1 c√¢bles","N(N-1)/2 c√¢bles","N¬≤ c√¢bles"],ans:2},
  {num:9,section:"R√©seaux & Topologies",q:"Dans quel cas est-il conseill√© d'utiliser une topologie en bus ?",opts:["Pour des r√©seaux de grande taille avec beaucoup d'utilisateurs","Pour des r√©seaux de petite taille avec une configuration fig√©e","Quand la reconfiguration fr√©quente est n√©cessaire","Quand un r√©seau √† haute vitesse est requis"],ans:1},
  {num:10,section:"R√©seaux & Topologies",q:"Quelle topologie est appel√©e aussi ¬´ topologie hi√©rarchique ¬ª ?",opts:["Topologie en anneau","Topologie hybride","Topologie en maille","Topologie en arbre"],ans:3},
  {num:11,section:"Architecture R√©seau",q:"Dans une architecture poste √† poste (peer-to-peer), comment sont organis√©s les ordinateurs ?",opts:["Un serveur central g√®re tous les clients","Tous les ordinateurs sont √©gaux, chacun est √† la fois client et serveur","Un ordinateur ma√Ætre contr√¥le tous les autres","Les machines sont organis√©es en hi√©rarchie stricte"],ans:1},
  {num:12,section:"Architecture R√©seau",q:"L'architecture poste √† poste est g√©n√©ralement adapt√©e pour un environnement avec :",opts:["Plus de 100 utilisateurs r√©partis sur plusieurs sites","Moins de 10 utilisateurs dans une m√™me zone g√©ographique","Un haut niveau de s√©curit√© requis","Un r√©seau amen√© √† √©voluer significativement"],ans:1},
  {num:13,section:"Architecture R√©seau",q:"Quel est le principal avantage du mod√®le client/serveur par rapport au mod√®le poste √† poste ?",opts:["Il est moins co√ªteux √† mettre en place","Il ne n√©cessite aucun administrateur r√©seau","Il offre une meilleure s√©curit√© et une administration centralis√©e","Il fonctionne sans serveur d√©di√©"],ans:2},
  {num:14,section:"Architecture R√©seau",q:"Dans le mod√®le client/serveur, que fait le client en premier dans une communication ?",opts:["Il envoie sa r√©ponse au serveur","Il √©met une requ√™te vers le serveur via son adresse IP","Il traite la demande du serveur","Il configure la connexion r√©seau"],ans:1},
  {num:15,section:"Architecture R√©seau",q:"Quel est l'inconv√©nient principal du mod√®le client/serveur ?",opts:["Les clients sont peu nombreux","L'administration est d√©centralis√©e","Le serveur est un point unique de d√©faillance et son co√ªt est √©lev√©","Il ne permet pas le partage de ressources"],ans:2},
  {num:16,section:"Adressage IP",q:"Combien de bits composent une adresse IPv4 ?",opts:["16 bits","32 bits","64 bits","128 bits"],ans:1},
  {num:17,section:"Adressage IP",q:"Une adresse IPv4 est compos√©e de deux parties. Lesquelles ?",opts:["Adresse MAC et adresse logique","Partie r√©seau et partie h√¥te","Adresse source et adresse destination","Adresse publique et adresse priv√©e"],ans:1},
  {num:18,section:"Adressage IP",q:"Quelle est la classe d'adresse IP dont la plage est 128.0.0.0 ‚Äì 191.255.255.255 ?",opts:["Classe A","Classe B","Classe C","Classe D"],ans:1},
  {num:19,section:"Adressage IP",q:"Quel est le masque par d√©faut de la classe C ?",opts:["255.0.0.0 (/8)","255.255.0.0 (/16)","255.255.255.0 (/24)","255.255.255.255 (/32)"],ans:2},
  {num:20,section:"Adressage IP",q:"Quel r√¥le joue l'adresse 127.0.0.1 ?",opts:["Adresse de broadcast g√©n√©ral","Adresse APIPA","Adresse de loopback (localhost)","Adresse non d√©finie"],ans:2},
  {num:21,section:"Adressage IP",q:"Quelle est la plage d'adresses priv√©es de classe A ?",opts:["172.16.0.0 ‚Äì 172.31.255.255","192.168.0.0 ‚Äì 192.168.255.255","10.0.0.0 ‚Äì 10.255.255.255","1.0.0.0 ‚Äì 126.255.255.255"],ans:2},
  {num:22,section:"Adressage IP",q:"Pourquoi les adresses IP priv√©es ne sont-elles pas routables sur Internet ?",opts:["Parce qu'elles sont r√©serv√©es aux r√©seaux militaires","Parce qu'elles sont utilis√©es uniquement en interne et non uniques globalement","Parce qu'elles sont de format IPv6","Parce qu'elles n√©cessitent un masque sp√©cial"],ans:1},
  {num:23,section:"Adressage IP",q:"Que repr√©sente l'adresse 255.255.255.255 ?",opts:["Adresse de loopback","Adresse non d√©finie","Broadcast g√©n√©ral","Adresse APIPA"],ans:2},
  {num:24,section:"Adressage IP",q:"Quelle est la plage d'adresses IP de classe A ?",opts:["1.0.0.0 ‚Äì 126.255.255.255","128.0.0.0 ‚Äì 191.255.255.255","192.0.0.0 ‚Äì 223.255.255.255","224.0.0.0 ‚Äì 239.255.255.255"],ans:0},
  {num:25,section:"Adressage IP",q:"Que d√©signe la plage d'adresses 169.254.x.x ?",opts:["Adresses publiques","Adresses APIPA (auto-configuration)","Adresses de multicast","Adresses de loopback"],ans:1},
  {num:26,section:"Adressage IP",q:"Quel est le r√¥le d'une adresse IP ?",opts:["Identifier physiquement la carte r√©seau","Identifier un h√¥te, localiser un r√©seau et permettre le routage des paquets","Chiffrer les communications","G√©rer la bande passante du r√©seau"],ans:1},
  {num:27,section:"Adressage IP",q:"Quelle est la plage d'adresses priv√©es de classe B ?",opts:["10.0.0.0 ‚Äì 10.255.255.255","172.16.0.0 ‚Äì 172.31.255.255","192.168.0.0 ‚Äì 192.168.255.255","128.0.0.0 ‚Äì 191.255.255.255"],ans:1},
  {num:28,section:"Adressage IP",q:"Pour l'adresse IP 192.168.1.10 avec le masque 255.255.255.0, quelle est la partie r√©seau ?",opts:["192.168","192.168.1","192.168.1.10","10"],ans:1},
  {num:29,section:"Routage & Commutation",q:"Quel √©quipement r√©seau permet d'interconnecter plusieurs r√©seaux IP diff√©rents ?",opts:["Hub (concentrateur)","Switch (commutateur)","Routeur","R√©p√©teur"],ans:2},
  {num:30,section:"Routage & Commutation",q:"Quelle est la principale fonction d'un switch (commutateur) ?",opts:["Connecter des r√©seaux de diff√©rentes technologies","Commuter des trames au niveau de la couche liaison en fonction des adresses MAC","Attribuer des adresses IP dynamiquement","Chiffrer les donn√©es transmises"],ans:1},
  {num:31,section:"Routage & Commutation",q:"Quelle est la diff√©rence principale entre un Hub et un Switch ?",opts:["Le Hub est plus rapide que le Switch","Le Hub diffuse √† tous les ports, le Switch envoie uniquement au port de destination","Le Switch fonctionne en mode sans-fil uniquement","Le Hub g√®re les adresses IP, le Switch g√®re les adresses MAC"],ans:1},
  {num:32,section:"Routage & Commutation",q:"Le routage permet d'acheminer les paquets en se basant sur :",opts:["Les adresses MAC des √©quipements","Le nom des machines","Les adresses IP source et destination","Le num√©ro de port physique"],ans:2},
  {num:33,section:"Mod√®le TCP/IP",q:"Combien de couches comporte le mod√®le TCP/IP ?",opts:["3 couches","4 couches","5 couches","7 couches"],ans:1},
  {num:34,section:"Mod√®le TCP/IP",q:"Quelle couche du mod√®le TCP/IP est responsable de l'acheminement des paquets entre r√©seaux ?",opts:["Couche Application","Couche Transport","Couche Internet (R√©seau)","Couche Acc√®s R√©seau"],ans:2},
  {num:35,section:"Mod√®le TCP/IP",q:"Quel protocole de la couche Transport du mod√®le TCP/IP garantit la livraison fiable des donn√©es ?",opts:["IP","UDP","TCP","ICMP"],ans:2},
  {num:36,section:"Mod√®le TCP/IP",q:"Quelle est la signification de l'acronyme TCP/IP ?",opts:["Transfer Control Protocol / Internet Protocol","Transmission Control Protocol / Internet Protocol","Terminal Communication Protocol / Internet Protocol","Transmission Control Protocol / Intranet Protocol"],ans:1},
  {num:37,section:"Mod√®le TCP/IP",q:"Quel type de r√©seau couvre une zone g√©ographique restreinte (b√¢timent, campus) ?",opts:["WAN","MAN","LAN","VPN"],ans:2},
  {num:38,section:"Mod√®le TCP/IP",q:"Le protocole UDP se distingue de TCP par :",opts:["Sa garantie de livraison des donn√©es","Son contr√¥le d'erreur int√©gr√©","Son absence de connexion pr√©alable et de garantie de livraison","Sa capacit√© √† router les paquets"],ans:2},
  {num:39,section:"Mod√®le TCP/IP",q:"Quelle est la topologie la plus fr√©quemment utilis√©e dans les r√©seaux locaux modernes ?",opts:["Topologie en bus","Topologie en anneau","Topologie en √©toile","Topologie en maille"],ans:2},
  {num:40,section:"Mod√®le TCP/IP",q:"Lequel des √©l√©ments suivants est un exemple d'adresse IP de classe C priv√©e ?",opts:["10.0.0.1","172.20.0.1","192.168.10.5","200.168.10.5"],ans:2},
];

const LABELS = ["A","B","C","D"];
const TOTAL = 90*60;
const SEC_COLORS = {
  "R√©seaux & Topologies":{bg:"#0f4c75",pill:"#63b3ed"},
  "Architecture R√©seau":{bg:"#1a3a1a",pill:"#68d391"},
  "Adressage IP":{bg:"#4a1942",pill:"#d6bcfa"},
  "Routage & Commutation":{bg:"#7c3100",pill:"#fbd38d"},
  "Mod√®le TCP/IP":{bg:"#1a365d",pill:"#90cdf4"},
};
const SECTIONS = ["R√©seaux & Topologies","Architecture R√©seau","Adressage IP","Routage & Commutation","Mod√®le TCP/IP"];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let user = {nom:"",prenom:"",spec:""};
let answers = new Array(40).fill(null);
let current = 0;
let timeLeft = TOTAL;
let timerInterval = null;
let submitted = false;
let timedOut = false;
let synced = false;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function $(id){return document.getElementById(id);}
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>{s.classList.remove('active');});
  $(id).classList.add('active');
  $(id).classList.add('slide-up');
  setTimeout(()=>$(id).classList.remove('slide-up'),500);
}
function formatTime(s){
  const h=Math.floor(s/3600),m=Math.floor((s%3600)/60),ss=s%60;
  return (h>0?h+":":"")+String(m).padStart(2,'0')+":"+String(ss).padStart(2,'0');
}
function getMention(score){
  const p=score/40;
  if(p>=.9) return{label:"Excellent !",color:"#ffd700"};
  if(p>=.75) return{label:"Tr√®s Bien",color:"#68d391"};
  if(p>=.6) return{label:"Bien",color:"#90cdf4"};
  if(p>=.5) return{label:"Passable",color:"#fbd38d"};
  return{label:"Insuffisant",color:"#fc8181"};
}
function answeredCount(){return answers.filter(a=>a!==null).length;}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  LOGIN
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function startExam(){
  const nom=$('inputNom').value.trim();
  const prenom=$('inputPrenom').value.trim();
  const spec=$('inputSpec').value.trim();
  const err=$('loginError');
  if(!nom||!prenom){err.style.display='block';err.textContent='‚ö†Ô∏è Veuillez entrer votre nom et pr√©nom.';return;}
  if(!spec){err.style.display='block';err.textContent='‚ö†Ô∏è Veuillez entrer votre sp√©cialit√©.';return;}
  err.style.display='none';
  user={nom,prenom,spec};
  answers=new Array(40).fill(null);
  current=0;timeLeft=TOTAL;submitted=false;timedOut=false;synced=false;
  initQCM();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  QCM INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function initQCM(){
  $('avatarEl').textContent=user.prenom[0]+user.nom[0];
  $('uName').textContent=user.prenom+' '+user.nom;
  $('uSpec').textContent=user.spec;
  showScreen('qcmScreen');
  renderQuestion();
  startTimer();
}

function startTimer(){
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    timeLeft--;
    updateTimerDisplay();
    if(timeLeft<=0){
      clearInterval(timerInterval);
      timedOut=true;
      submitExam(true);
    }
  },1000);
  updateTimerDisplay();
}

function updateTimerDisplay(){
  const el=$('timerEl'), dot=$('tdot'), txt=$('timerText');
  txt.textContent=formatTime(timeLeft);
  if(timeLeft<=300){el.classList.add('urgent');dot.classList.add('urgent');}
  else{el.classList.remove('urgent');dot.classList.remove('urgent');}
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  RENDER QUESTION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderQuestion(){
  const q=QUESTIONS[current];
  const sc=SEC_COLORS[q.section]||{bg:"#1a1a2e",pill:"#aaa"};

  // Header
  $('progFill').style.width=(answeredCount()/40*100)+'%';
  $('progText').textContent=answeredCount()+'/40 r√©pondues';
  $('qPosText').textContent='Q'+(current+1)+' sur 40';

  // Nav buttons
  $('btnPrev').disabled=current===0;
  $('btnNext').style.display=current<39?'':'none';
  $('btnSubmit').style.display=current===39?'':'none';

  // Body
  const body=$('qcmBody');
  body.innerHTML=`
    <div class="sec-pill" style="background:${sc.bg};color:${sc.pill}">‚óè ${q.section}</div>
    <div class="q-num">QUESTION ${q.num} / 40</div>
    <div class="q-text">${q.q}</div>
    <div class="options" id="optsList"></div>
  `;
  const opts=document.getElementById('optsList');
  q.opts.forEach((opt,i)=>{
    const btn=document.createElement('button');
    btn.className='opt'+(answers[current]===i?' selected':'');
    btn.innerHTML=`<div class="opt-label">${LABELS[i]}</div><div class="opt-text">${opt}</div>`;
    btn.onclick=()=>selectAnswer(i);
    opts.appendChild(btn);
  });
}

function selectAnswer(idx){
  if(submitted)return;
  answers[current]=idx;
  renderQuestion();
}

function navigate(dir){
  current=Math.max(0,Math.min(39,current+dir));
  renderQuestion();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  MAP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
$('btnMap').onclick=()=>{
  const grid=$('mapGrid');
  grid.innerHTML='';
  $('mapTitle').textContent='üìã Navigation ‚Äî '+answeredCount()+'/40 r√©pondues';
  QUESTIONS.forEach((_,i)=>{
    const cell=document.createElement('div');
    cell.className='map-cell'+(i===current?' current':answers[i]!==null?' answered':'');
    cell.textContent=i+1;
    cell.onclick=()=>{current=i;renderQuestion();closeMap(null,true);};
    grid.appendChild(cell);
  });
  $('mapModal').classList.add('open');
};
function closeMap(e,force=false){if(force||e.target===$('mapModal'))$('mapModal').classList.remove('open');}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  CONFIRM + SUBMIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openConfirm(){
  const cnt=answeredCount();
  const missing=40-cnt;
  $('confirmSub').innerHTML=`Vous avez r√©pondu √† <strong>${cnt} / 40</strong> questions.<br>`+
    (missing>0?`<span style="color:#fc8181">${missing} question(s) sans r√©ponse.</span><br>`:'')+
    `Temps restant : <strong>${formatTime(timeLeft)}</strong>`;
  $('confirmModal').classList.add('open');
}
function closeConfirm(){$('confirmModal').classList.remove('open');}

function submitExam(auto=false){
  clearInterval(timerInterval);
  submitted=true;
  $('confirmModal').classList.remove('open');
  showResults(auto);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  RESULTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showResults(auto){
  showScreen('resultsScreen');
  if(auto||timedOut) $('timeoutBadge').style.display='block';
  else $('timeoutBadge').style.display='none';

  const score=answers.filter((a,i)=>a===QUESTIONS[i].ans).length;
  const mention=getMention(score);
  const pct=score/40;
  const circ=2*Math.PI*54;

  $('scoreNum').textContent=score;
  $('scoreNum').style.color=mention.color;
  $('scoreGrade').textContent=mention.label;
  $('scoreGrade').style.color=mention.color;
  $('scoreUser').textContent=user.prenom+' '+user.nom+' ‚Äî '+user.spec;

  // Animate ring
  const ring=$('ringFill');
  ring.style.stroke=mention.color;
  ring.style.strokeDashoffset=circ;
  setTimeout(()=>{ring.style.strokeDashoffset=circ*(1-pct);},100);

  // Stats
  $('statsRow').innerHTML=`
    <div class="stat-card"><div class="stat-val" style="color:#68d391">${score}</div><div class="stat-lbl">Correctes</div></div>
    <div class="stat-card"><div class="stat-val" style="color:#fc8181">${40-score}</div><div class="stat-lbl">Incorrectes</div></div>
    <div class="stat-card"><div class="stat-val" style="color:#90cdf4">${Math.round(pct*100)}%</div><div class="stat-lbl">Score</div></div>
  `;

  // Section results
  const secDiv=$('sectionResults');
  secDiv.innerHTML='';
  SECTIONS.forEach(sec=>{
    const secQs=QUESTIONS.filter(q=>q.section===sec);
    const secScore=secQs.filter(q=>answers[q.num-1]===q.ans).length;
    const col=SEC_COLORS[sec]||{pill:"#aaa"};
    let html=`<div class="sec-results"><h3 style="color:${col.pill}">${sec} ‚Äî ${secScore}/${secQs.length}</h3>`;
    secQs.forEach(q=>{
      const ua=answers[q.num-1];
      const ok=ua===q.ans;
      html+=`<div class="result-item">
        <div class="r-icon">${ok?'‚úÖ':'‚ùå'}</div>
        <div style="flex:1">
          <div class="r-q"><strong>Q${q.num}.</strong> ${q.q}</div>
          <div class="r-a ${ok?'ok':'ko'}">Votre r√©ponse : ${ua!==null?LABELS[ua]+'. '+q.opts[ua]:'Sans r√©ponse'}</div>
          ${!ok?`<div class="r-correct">‚úì Bonne r√©ponse : ${LABELS[q.ans]}. ${q.opts[q.ans]}</div>`:''}
        </div>
      </div>`;
    });
    html+='</div>';
    secDiv.innerHTML+=html;
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  SYNC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function syncResults(){
  if(synced)return;
  const score=answers.filter((a,i)=>a===QUESTIONS[i].ans).length;
  const mention=getMention(score);
  const data={
    nom:user.nom, prenom:user.prenom, specialite:user.spec,
    score, total:40, mention:mention.label,
    pourcentage:Math.round(score/40*100),
    timeUsed:TOTAL-timeLeft,
    submittedAt:new Date().toLocaleString('fr-FR'),
    answers:answers.map((a,i)=>({q:i+1,userAns:a,correct:QUESTIONS[i].ans,ok:a===QUESTIONS[i].ans}))
  };

  // Save locally
  try{
    const key='qcm_result_'+user.nom+'_'+user.prenom+'_'+Date.now();
    localStorage.setItem(key,JSON.stringify(data));
  }catch(e){}

  synced=true;
  const btn=$('syncBtn');
  btn.textContent='‚úÖ Donn√©es synchronis√©es ‚Äî '+new Date().toLocaleTimeString('fr-FR');
  btn.classList.add('synced');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  RESET
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function resetApp(){
  clearInterval(timerInterval);
  answers=new Array(40).fill(null);
  current=0;timeLeft=TOTAL;submitted=false;timedOut=false;synced=false;
  $('syncBtn').textContent='üì° Synchroniser mes r√©sultats';
  $('syncBtn').classList.remove('synced');
  $('inputNom').value='';$('inputPrenom').value='';$('inputSpec').value='';
  showScreen('loginScreen');
}

// ‚îÄ‚îÄ Enter key on login
['inputNom','inputPrenom','inputSpec'].forEach(id=>{
  $(id).addEventListener('keydown',e=>{if(e.key==='Enter')startExam();});
});
</script>
</body>
</html>